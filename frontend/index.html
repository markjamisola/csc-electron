<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Image Processing Studio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
      @keyframes slideIn {
        from {
          transform: translateX(400px);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }
      .animate-slide-in {
        animation: slideIn 0.3s ease-out;
      }
    </style>
  </head>
  <body class="bg-gray-900 min-h-screen text-white">
    <!-- Success Notification Toast -->
    <div id="successToast" class="fixed top-4 right-4 z-50 hidden">
      <div class="bg-green-600 text-white px-6 py-4 rounded-lg shadow-2xl flex items-center gap-3 animate-slide-in">
        <i data-feather="check-circle" class="w-6 h-6"></i>
        <div>
          <p class="font-semibold">Download Successful!</p>
          <p class="text-sm text-green-100" id="toastMessage">Image downloaded successfully</p>
        </div>
      </div>
    </div>

    <!-- Header -->
    <div class="bg-gray-800 shadow-lg">
      <div class="max-w-7xl mx-auto px-6 py-4">
        <h1 class="text-2xl font-bold text-green-400 flex items-center gap-2">
          <i data-feather="image" class="w-6 h-6"></i>
          Image Processing Studio
        </h1>
        <p class="text-gray-400 text-sm">Professional image processing with OpenCV</p>
      </div>
    </div>

    <div class="max-w-7xl mx-auto px-6 py-6">
      <!-- Batch Management Section -->
      <div id="batchSection" class="mb-8">
        <div class="bg-gray-800 rounded-xl p-6 shadow-lg">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-semibold text-green-400 flex items-center gap-2">
              <i data-feather="folder" class="w-5 h-5"></i>
              Current Batch
            </h2>
            <div class="flex gap-3">
              <button onclick="showBatchModal()" 
                class="flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition text-sm">
                <i data-feather="plus" class="w-4 h-4"></i> New Batch
              </button>
              <a href="savedbatches.html" 
                class="flex items-center gap-2 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition text-sm">
                <i data-feather="archive" class="w-4 h-4"></i> Saved Batches
              </a>
            </div>
          </div>
          
          <!-- Current Batch Info -->
          <div id="noBatchMessage" class="text-center py-8 text-gray-400">
            <i data-feather="folder-plus" class="w-12 h-12 mx-auto mb-3 opacity-50"></i>
            <p>No batch selected. Create a new batch to get started.</p>
          </div>
          
          <div id="currentBatchInfo" class="hidden">
            <div class="bg-gray-700 rounded-lg p-4 mb-4">
              <div class="flex items-center justify-between">
                <div>
                  <h3 class="font-semibold text-white" id="batchNameDisplay">Batch Name</h3>
                  <p class="text-sm text-gray-400">Batch ID: <span id="batchIdDisplay">-</span></p>
                </div>
                <div class="text-right">
                  <p class="text-sm text-gray-400">Images: <span id="imageCountDisplay">0</span></p>
                </div>
              </div>
            </div>
            
            <!-- File Upload Area -->
            <div class="border-2 border-dashed border-gray-600 rounded-lg p-6 text-center hover:border-green-400 transition">
              <input type="file" id="fileInput" multiple accept="image/*" class="hidden" onchange="handleFileUpload()" />
              <label for="fileInput" class="cursor-pointer">
                <i data-feather="upload-cloud" class="w-12 h-12 mx-auto mb-3 text-gray-400"></i>
                <p class="text-gray-300 mb-2">Click to upload images or drag and drop</p>
                <p class="text-sm text-gray-500">Supports: JPG, PNG, GIF, BMP</p>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Image Gallery Section -->
      <div id="imageGallerySection" class="hidden mb-8">
        <div class="bg-gray-800 rounded-xl p-6 shadow-lg">
          <h2 class="text-xl font-semibold text-green-400 mb-4 flex items-center gap-2">
            <i data-feather="grid" class="w-5 h-5"></i>
            Image Gallery
          </h2>
          <div id="imageGallery" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
            <!-- Images will be displayed here -->
          </div>
        </div>
      </div>

      <!-- Image Processing Panel -->
      <div id="processingPanel" class="hidden">
        <div class="bg-gray-800 rounded-xl p-6 shadow-lg">
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-xl font-semibold text-green-400 flex items-center gap-2">
              <i data-feather="settings" class="w-5 h-5"></i>
              Image Processing
            </h2>
            <button onclick="closeProcessingPanel()" class="text-gray-400 hover:text-white">
              <i data-feather="x" class="w-5 h-5"></i>
            </button>
          </div>

          <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Selected Image Display -->
            <div class="lg:col-span-1">
              <h3 class="text-lg font-medium mb-3">Selected Image</h3>
              <div class="bg-gray-700 rounded-lg p-4">
                <img id="selectedImagePreview" class="w-full rounded-lg mb-3" />
                <div id="selectedImageInfo" class="text-sm text-gray-400">
                  <!-- Image info will be shown here -->
                </div>
              </div>
            </div>

            <!-- Processing Options -->
            <div class="lg:col-span-1">
              <h3 class="text-lg font-medium mb-3">Processing Options</h3>
              <div class="space-y-4">
                <!-- Image Information -->
                <div class="bg-gray-700 rounded-lg p-4">
                  <h4 class="font-medium mb-2 flex items-center gap-2">
                    <i data-feather="info" class="w-4 h-4"></i>
                    Image Information
                  </h4>
                  <button onclick="showImageDimensions()" 
                    class="w-full px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition text-sm">
                    Show Dimensions
                  </button>
                </div>

                <!-- Filters -->
                <div class="bg-gray-700 rounded-lg p-4">
                  <h4 class="font-medium mb-3 flex items-center gap-2">
                    <i data-feather="sliders" class="w-4 h-4"></i>
                    Apply Filter
                  </h4>
                  <select id="filterSelect" class="w-full px-3 py-2 rounded bg-gray-600 text-white border border-gray-500 mb-3">
                    <option value="grayscale">Grayscale</option>
                    <option value="canny">Edge Detection</option>
                    <option value="blur">Blur</option>
                    
                    <optgroup label="HSV Color Space">
                      <option value="hsv">HSV Color Space</option>
                      <option value="hsv_hue">HSV - Hue Channel Only</option>
                      <option value="hsv_saturation">HSV - Saturation Channel Only</option>
                      <option value="hsv_value">HSV - Value Channel Only</option>
                    </optgroup>
                    
                    <optgroup label="BGR Channel Separation (Grayscale)">
                      <option value="blue_channel_gray">Blue Channel (Grayscale)</option>
                      <option value="green_channel_gray">Green Channel (Grayscale)</option>
                      <option value="red_channel_gray">Red Channel (Grayscale)</option>
                    </optgroup>
                    
                    <optgroup label="BGR Channel Isolation (Color)">
                      <option value="blue_channel_only">Blue Channel Only</option>
                      <option value="green_channel_only">Green Channel Only</option>
                      <option value="red_channel_only">Red Channel Only</option>
                    </optgroup>
                    
                    <optgroup label="BGR Channel Enhancement">
                      <option value="blue_boost">Blue Boost (+100)</option>
                      <option value="green_boost">Green Boost (+100)</option>
                      <option value="red_boost">Red Boost (+100)</option>
                    </optgroup>
                    
                    <optgroup label="Drawing & Shapes">
                      <option value="add_diagonal_line">Add Diagonal Line</option>
                      <option value="add_rectangle">Add Rectangle</option>
                      <option value="add_circle">Add Circle</option>
                      <option value="add_polygon">Add Polygon</option>
                      <option value="add_text">Add Text</option>
                    </optgroup>
                    
                    <optgroup label="Transformations">
                      <option value="translate_right">Translate Right</option>
                      <option value="translate_down">Translate Down</option>
                      <option value="rotate_45">Rotate 45°</option>
                      <option value="rotate_90">Rotate 90°</option>
                      <option value="flip_horizontal">Flip Horizontal</option>
                      <option value="flip_vertical">Flip Vertical</option>
                    </optgroup>
                    
                    <optgroup label="Scaling & Cropping">
                      <option value="resize_50">Resize to 50%</option>
                      <option value="resize_200">Resize to 200%</option>
                      <option value="crop_center">Crop Center 50%</option>
                    </optgroup>
                    
                    <optgroup label="Arithmetic Operations">
                      <option value="brighten">Brighten (+50)</option>
                      <option value="darken">Darken (-50)</option>
                      <option value="contrast">Increase Contrast</option>
                      <option value="bitwise_not">Invert Colors</option>
                    </optgroup>
                    
                    <optgroup label="Blurring & Sharpening">
                      <option value="gaussian_blur">Gaussian Blur</option>
                      <option value="median_blur">Median Blur</option>
                      <option value="bilateral_filter">Bilateral Filter</option>
                      <option value="sharpen">Sharpen</option>
                    </optgroup>
                    
                    <optgroup label="Thresholding">
                      <option value="threshold_binary">Binary Threshold</option>
                      <option value="threshold_otsu">Otsu's Threshold</option>
                      <option value="adaptive_threshold">Adaptive Threshold</option>
                    </optgroup>
                    
                    <optgroup label="Morphological & Edge Detection">
                      <option value="dilate">Dilation</option>
                      <option value="erode">Erosion</option>
                      <option value="morphological_gradient">Morphological Gradient</option>
                      <option value="sobel_x">Sobel Edge (X)</option>
                      <option value="sobel_y">Sobel Edge (Y)</option>
                      <option value="laplacian">Laplacian Edge</option>
                    </optgroup>
                  </select>
                  <div id="filterInfo" class="text-xs text-gray-400 mb-3 p-2 bg-gray-600 rounded">
                    <strong>Selected:</strong> Select a filter to see description.
                  </div>
                  <button onclick="applyFilter()" 
                    class="w-full px-3 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition text-sm">
                    Apply Filter
                  </button>
                </div>
              </div>
            </div>

            <!-- Results -->
            <div class="lg:col-span-1">
              <h3 class="text-lg font-medium mb-3">Results</h3>
              <div id="resultsArea" class="bg-gray-700 rounded-lg p-4 min-h-96">
                <div class="text-center text-gray-500 py-8">
                  <i data-feather="image" class="w-12 h-12 mx-auto mb-3 opacity-50"></i>
                  <p>Results will appear here</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Batch Creation Modal -->
    <div id="batchModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
      <div class="bg-gray-800 rounded-xl shadow-2xl p-6 w-full max-w-md">
        <h2 class="text-xl font-bold text-green-400 mb-4 flex items-center gap-2">
          <i data-feather="folder-plus" class="w-5 h-5"></i>
          Create New Batch
        </h2>
        <div class="mb-4">
          <label class="block text-gray-300 mb-2" for="modalBatchName">Batch Name</label>
          <input id="modalBatchName" type="text" placeholder="Enter batch name..." 
            class="w-full px-4 py-3 rounded-lg border border-gray-600 bg-gray-700 text-gray-200 focus:ring-2 focus:ring-green-400 focus:border-transparent" />
        </div>
        <div class="flex justify-end gap-3">
          <button onclick="hideBatchModal()" 
            class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition">
            Cancel
          </button>
          <button onclick="createBatch()" 
            class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition">
            Create Batch
          </button>
        </div>
      </div>
    </div>

    <!-- Download Format Modal -->
    <div id="downloadModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
      <div class="bg-gray-800 rounded-xl shadow-2xl p-6 w-full max-w-md">
        <h2 class="text-xl font-bold text-green-400 mb-4 flex items-center gap-2">
          <i data-feather="download" class="w-5 h-5"></i>
          Download Processed Image
        </h2>
        <p class="text-gray-300 mb-4">Choose the format for your processed image:</p>
        <div class="space-y-3 mb-6">
          <button onclick="downloadImage('png')" 
            class="w-full px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center justify-between">
            <span>PNG Format</span>
            <span class="text-xs text-gray-200">Lossless, larger file size</span>
          </button>
          <button onclick="downloadImage('jpg')" 
            class="w-full px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition flex items-center justify-between">
            <span>JPG Format</span>
            <span class="text-xs text-gray-200">Compressed, smaller file size</span>
          </button>
          <button onclick="downloadImage('jpeg')" 
            class="w-full px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition flex items-center justify-between">
            <span>JPEG Format</span>
            <span class="text-xs text-gray-200">Same as JPG</span>
          </button>
        </div>
        <div class="flex justify-end">
          <button onclick="hideDownloadModal()" 
            class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition">
            Cancel
          </button>
        </div>
      </div>
    </div>

    <script>
      // Initialize Feather icons
      feather.replace();
      
      // Global variables
      let currentBatchId = null;
      let currentBatchName = null;
      let selectedImageFile = null;
      let uploadedImages = [];
      let currentProcessedImageId = null;

      // Toast Notification Function
      function showSuccessToast(message) {
        const toast = document.getElementById("successToast");
        const toastMessage = document.getElementById("toastMessage");
        
        toastMessage.textContent = message;
        toast.classList.remove("hidden");
        feather.replace();
        
        // Auto-hide after 3 seconds
        setTimeout(() => {
          toast.classList.add("hidden");
        }, 3000);
      }

      // Batch Management Functions
      function showBatchModal() {
        document.getElementById("batchModal").classList.remove("hidden");
        document.getElementById("modalBatchName").focus();
      }

      function hideBatchModal() {
        document.getElementById("batchModal").classList.add("hidden");
        document.getElementById("modalBatchName").value = "";
      }

      async function createBatch() {
        const name = document.getElementById("modalBatchName").value.trim();
        if (!name) {
          alert("Please enter a batch name.");
          return;
        }

        try {
          const formData = new FormData();
          formData.append("name", name);

          const response = await fetch("http://127.0.0.1:8001/batches/", {
            method: "POST",
            body: formData,
          });

          if (!response.ok) {
            throw new Error("Failed to create batch");
          }

          const data = await response.json();
          currentBatchId = data.id;
          currentBatchName = data.name;

          // Update UI
          document.getElementById("noBatchMessage").classList.add("hidden");
          document.getElementById("currentBatchInfo").classList.remove("hidden");
          document.getElementById("batchNameDisplay").textContent = name;
          document.getElementById("batchIdDisplay").textContent = data.id;
          document.getElementById("imageCountDisplay").textContent = "0";

          hideBatchModal();
          uploadedImages = [];
          
          showSuccessToast(`Batch "${name}" created successfully!`);
        } catch (error) {
          console.error("Error creating batch:", error);
          alert("Failed to create batch. Please try again.");
        }
      }

      // File Upload Functions
      function handleFileUpload() {
        const fileInput = document.getElementById("fileInput");
        const files = Array.from(fileInput.files);
        
        files.forEach(file => {
          const imageData = {
            file: file,
            name: file.name,
            size: file.size,
            url: URL.createObjectURL(file),
            id: Date.now() + Math.random()
          };
          uploadedImages.push(imageData);
        });

        updateImageGallery();
        updateImageCount();
      }

      function updateImageGallery() {
        const gallery = document.getElementById("imageGallery");
        const gallerySection = document.getElementById("imageGallerySection");
        
        if (uploadedImages.length === 0) {
          gallerySection.classList.add("hidden");
          return;
        }

        gallerySection.classList.remove("hidden");
        gallery.innerHTML = "";

        uploadedImages.forEach((imageData, index) => {
          const imageCard = document.createElement("div");
          imageCard.className = "bg-gray-700 rounded-lg p-2 hover:bg-gray-600 transition cursor-pointer";
          imageCard.onclick = () => selectImage(imageData, index);
          
          imageCard.innerHTML = `
            <img src="${imageData.url}" alt="${imageData.name}" class="w-full h-24 object-cover rounded mb-2">
            <p class="text-xs text-gray-300 truncate">${imageData.name}</p>
            <p class="text-xs text-gray-500">${(imageData.size / 1024).toFixed(1)} KB</p>
          `;
          
          gallery.appendChild(imageCard);
        });
      }

      function updateImageCount() {
        document.getElementById("imageCountDisplay").textContent = uploadedImages.length;
      }

      // Image Selection and Processing
      function selectImage(imageData, index) {
        selectedImageFile = imageData;
        
        // Show processing panel
        document.getElementById("processingPanel").classList.remove("hidden");
        
        // Update selected image preview
        document.getElementById("selectedImagePreview").src = imageData.url;
        document.getElementById("selectedImageInfo").innerHTML = `
          <p><strong>Name:</strong> ${imageData.name}</p>
          <p><strong>Size:</strong> ${(imageData.size / 1024).toFixed(1)} KB</p>
        `;
        
        // Clear previous results
        document.getElementById("resultsArea").innerHTML = `
          <div class="text-center text-gray-500 py-8">
            <i data-feather="image" class="w-12 h-12 mx-auto mb-3 opacity-50"></i>
            <p>Results will appear here</p>
          </div>
        `;
        feather.replace();
      }

      function closeProcessingPanel() {
        document.getElementById("processingPanel").classList.add("hidden");
        selectedImageFile = null;
        currentProcessedImageId = null;
      }

      // Processing Functions
      async function showImageDimensions() {
        if (!selectedImageFile) {
          alert("Please select an image first.");
          return;
        }

        const img = new Image();
        img.onload = function() {
          const resultsArea = document.getElementById("resultsArea");
          resultsArea.innerHTML = `
            <div class="bg-blue-900 bg-opacity-30 rounded-lg p-4">
              <h4 class="font-semibold text-blue-400 mb-3 flex items-center gap-2">
                <i data-feather="info" class="w-4 h-4"></i>
                Image Dimensions
              </h4>
              <div class="space-y-2 text-sm">
                <p><strong>Height:</strong> ${this.naturalHeight} pixels</p>
                <p><strong>Width:</strong> ${this.naturalWidth} pixels</p>
                <p><strong>Aspect Ratio:</strong> ${(this.naturalWidth / this.naturalHeight).toFixed(2)}</p>
                <p><strong>File Size:</strong> ${(selectedImageFile.size / 1024).toFixed(1)} KB</p>
                <p><strong>Total Pixels:</strong> ${(this.naturalHeight * this.naturalWidth).toLocaleString()}</p>
              </div>
            </div>
          `;
          feather.replace();
        };
        img.src = selectedImageFile.url;
      }

      async function applyFilter() {
        if (!selectedImageFile || !currentBatchId) {
          alert("Please select an image and create a batch first.");
          return;
        }

        const filter = document.getElementById("filterSelect").value;
        const formData = new FormData();
        formData.append("file", selectedImageFile.file);
        formData.append("operation", filter);
        formData.append("batch_id", currentBatchId);

        try {
          const response = await fetch("http://127.0.0.1:8001/process-with-info/", {
            method: "POST",
            body: formData,
          });

          if (!response.ok) {
            throw new Error("Failed to process image");
          }

          const result = await response.json();
          currentProcessedImageId = result.image_id;
          
          const resultsArea = document.getElementById("resultsArea");
          resultsArea.innerHTML = `
            <div class="space-y-4">
              <div class="bg-green-900 bg-opacity-30 rounded-lg p-4">
                <h4 class="font-semibold text-green-400 mb-3 flex items-center gap-2">
                  <i data-feather="check-circle" class="w-4 h-4"></i>
                  Filter Applied: ${filter}
                </h4>
                <img src="${result.image_data}" alt="Processed" class="w-full rounded-lg mb-3">
                <div class="text-sm space-y-1 mb-4">
                  <p><strong>Original:</strong> ${result.original_dimensions.formatted}</p>
                  <p><strong>Processed:</strong> ${result.processed_dimensions.formatted}</p>
                </div>
                <button onclick="showDownloadModal()" 
                  class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center justify-center gap-2">
                  <i data-feather="download" class="w-4 h-4"></i>
                  Download Image
                </button>
              </div>
            </div>
          `;
          feather.replace();
          
          showSuccessToast(`Filter "${filter}" applied successfully!`);
        } catch (error) {
          console.error("Error processing image:", error);
          alert("Failed to process image. Please try again.");
        }
      }

      // Download Functions
      function showDownloadModal() {
        if (!currentProcessedImageId) {
          alert("No processed image available for download.");
          return;
        }
        document.getElementById("downloadModal").classList.remove("hidden");
      }

      function hideDownloadModal() {
        document.getElementById("downloadModal").classList.add("hidden");
      }

      async function downloadImage(format) {
        if (!currentProcessedImageId) {
          alert("No processed image available for download.");
          return;
        }

        try {
          const downloadUrl = `http://127.0.0.1:8001/images/${currentProcessedImageId}/download?format=${format}`;
          
          const link = document.createElement('a');
          link.href = downloadUrl;
          link.download = `processed_${currentProcessedImageId}.${format}`;
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          
          hideDownloadModal();
          
          // Show success toast
          showSuccessToast(`Image successfully downloaded as ${format.toUpperCase()}!`);
          
        } catch (error) {
          console.error("Error downloading image:", error);
          alert("Failed to download image. Please try again.");
        }
      }

      // Dynamic filter information update
      function updateFilterInfo() {
        const filterSelect = document.getElementById("filterSelect");
        const filterInfo = document.getElementById("filterInfo");
        const selectedFilter = filterSelect.value;
        
        const filterDescriptions = {
          "grayscale": "Converts image to grayscale by removing color information.",
          "canny": "Edge detection using Canny algorithm to find object boundaries.",
          "blur": "Gaussian blur to reduce noise and detail in the image.",
          "hsv": "Converts BGR to HSV color space (Hue, Saturation, Value).",
          "hsv_hue": "Extracts only the Hue channel showing color information.",
          "hsv_saturation": "Extracts Saturation channel showing color intensity.",
          "hsv_value": "Extracts Value channel showing brightness information.",
          "blue_channel_gray": "Shows blue channel intensity as grayscale image.",
          "green_channel_gray": "Shows green channel intensity as grayscale image.", 
          "red_channel_gray": "Shows red channel intensity as grayscale image.",
          "blue_channel_only": "Isolates blue channel, zeroing out red and green.",
          "green_channel_only": "Isolates green channel, zeroing out red and blue.",
          "red_channel_only": "Isolates red channel, zeroing out green and blue.",
          "blue_boost": "Amplifies blue channel by adding +100 to blue values.",
          "green_boost": "Amplifies green channel by adding +100 to green values.",
          "red_boost": "Amplifies red channel by adding +100 to red values.",
          "add_diagonal_line": "Draws a diagonal line across your image using cv2.line().",
          "add_rectangle": "Draws a rectangle on your image using cv2.rectangle().",
          "add_circle": "Draws a filled circle on your image using cv2.circle().",
          "add_polygon": "Draws a polygon shape on your image using cv2.polylines().",
          "add_text": "Adds text overlay to your image using cv2.putText().",
          "translate_right": "Shifts image 100 pixels to the right.",
          "translate_down": "Shifts image 100 pixels downward.",
          "rotate_45": "Rotates image 45 degrees clockwise.",
          "rotate_90": "Rotates image 90 degrees clockwise.",
          "flip_horizontal": "Flips image horizontally (mirror effect).",
          "flip_vertical": "Flips image vertically (upside down).",
          "resize_50": "Reduces image size to 50% of original dimensions.",
          "resize_200": "Enlarges image to 200% of original dimensions.",
          "crop_center": "Crops and extracts the center 50% of the image.",
          "brighten": "Increases overall brightness by adding 50 to all pixels.",
          "darken": "Decreases overall brightness by subtracting 50 from all pixels.",
          "contrast": "Increases image contrast by multiplying pixel values by 1.5.",
          "bitwise_not": "Inverts all colors (creates negative effect).",
          "gaussian_blur": "Applies strong Gaussian blur for smooth effect.",
          "median_blur": "Applies median blur to remove noise while preserving edges.",
          "bilateral_filter": "Smooths image while preserving sharp edges.",
          "sharpen": "Enhances edges and details using sharpening kernel.",
          "threshold_binary": "Converts to binary image (black and white only).",
          "threshold_otsu": "Automatic binary threshold using Otsu's method.",
          "adaptive_threshold": "Adaptive thresholding for varying lighting conditions.",
          "dilate": "Expands bright regions using morphological dilation.",
          "erode": "Shrinks bright regions using morphological erosion.",
          "morphological_gradient": "Shows edges by computing dilation minus erosion.",
          "sobel_x": "Detects vertical edges using Sobel operator (X-direction).",
          "sobel_y": "Detects horizontal edges using Sobel operator (Y-direction).",
          "laplacian": "Detects all edges using Laplacian operator."
        };
        
        filterInfo.innerHTML = `<strong>Selected:</strong> ${filterDescriptions[selectedFilter] || "Select a filter to see description."}`;
      }

      // Initialize page
      document.addEventListener("DOMContentLoaded", function() {
        feather.replace();
        
        // Add event listener for filter selection change
        const filterSelect = document.getElementById("filterSelect");
        filterSelect.addEventListener("change", updateFilterInfo);
        
        // Initialize filter info
        updateFilterInfo();
      });
    </script>
  </body>
</html>